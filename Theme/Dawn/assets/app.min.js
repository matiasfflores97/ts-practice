(()=>{"use strict";var t=function(t,e,r,n){return new(r||(r=Promise))((function(a,i){function o(t){try{c(n.next(t))}catch(t){i(t)}}function d(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,d)}c((n=n.apply(t,e||[])).next())}))};const e=new class{constructor(){this.body=null,this.ajaxCartDrawer=null,this.ajaxCartDrawerItems=null,this.body=document.querySelector("body"),this.ajaxCartDrawer=document.querySelector("#CartDrawer"),this.ajaxCartDrawerItems=document.querySelector("#CartContainer .drawer__scrollable")}openDrawer(){this.ajaxCartDrawer.classList.add("drawer--opening"),this.body.classList.add("js-drawer-open")}closeDrawer(){this.ajaxCartDrawer.classList.remove("drawer--opening"),this.body.classList.remove("js-drawer-open")}addItem(e){return t(this,void 0,void 0,(function*(){try{const t=yield fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,quantity:e.quantity})}),r=yield t.json();return this.buildCart(),r}catch(t){throw t}}))}modifyItem(e){return t(this,void 0,void 0,(function*(){try{const t=yield fetch("/cart/change.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id.toString(),quantity:e.quantity})}),r=yield t.json();return this.buildCart(),r}catch(t){throw t}}))}getCart(){return t(this,void 0,void 0,(function*(){try{const t=yield fetch("/cart.js"),e=yield t.json(),r=e.items.map((t=>`<div class="ajaxcart-product">\n                    <button class="ajaxcart-product__remove" data-id="${t.id}">X</button>\n                    <div class="ajaxcart-product__image">\n                        <img src="${t.featured_image.url}" alt="${t.featured_image.alt}">\n                    </div>\n                    <div class="ajaxcart-product__meta">\n                        <h4>${t.title}</h4>\n                        <span>${Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t.original_price)}</span>\n                    </div>\n                 </div>\n                `)).join("");return this.ajaxCartDrawerItems.innerHTML=r,e}catch(t){throw"Error"}}))}buildCart(){return t(this,void 0,void 0,(function*(){yield this.getCart(),this.openDrawer()}))}};var r=function(t,e,r,n){return new(r||(r=Promise))((function(a,i){function o(t){try{c(n.next(t))}catch(t){i(t)}}function d(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,d)}c((n=n.apply(t,e||[])).next())}))};document.addEventListener("DOMContentLoaded",(()=>{const[...t]=document.querySelectorAll("button.add-to-cart"),[...n]=document.querySelectorAll(".ajaxcart-product__remove"),a=document.querySelector(".header__icon--cart"),i=document.querySelector(".drawer__close-button");t.forEach((t=>{t.addEventListener("click",(t=>r(void 0,void 0,void 0,(function*(){t.preventDefault();const r=t.target,n=r.form,a=parseInt(n.elements.id.value),i=parseInt(n.elements.quantity.value);r.classList.add("loading"),yield e.addItem({id:a,quantity:i}),r.classList.remove("loading")}))))})),n.forEach((t=>{t.addEventListener("click",(t=>r(void 0,void 0,void 0,(function*(){t.preventDefault();const r=t.target,n=Number(r.dataset.id);yield e.modifyItem({id:n,quantity:0})}))))})),a.addEventListener("click",(t=>r(void 0,void 0,void 0,(function*(){t.preventDefault(),e.openDrawer()})))),i.addEventListener("click",(t=>r(void 0,void 0,void 0,(function*(){t.preventDefault(),e.closeDrawer()}))))}))})();